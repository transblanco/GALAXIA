<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FFVV Transblanco J & M S.R.L ‚Äî Cierre KPI</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Paleta premium */
    :root{
      --bg:#0b1020;         /* fondo oscuro */
      --card:#0f1724;       /* tarjetas */
      --muted:#9ca3af;
      --accent:#7c3aed;     /* morado principal */
      --accent-2:#06b6d4;   /* cian */
      --comisional:#10b981; /* verde para comisional */
      --incentivos:#f97316; /* naranja para incentivos */
    }

    html,body { background: linear-gradient(180deg,#070712 0%, var(--bg) 100%); color:#e6eef8; font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

    .glass {
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));
      border: 1px solid rgba(255,255,255,0.04);
      backdrop-filter: blur(6px);
    }

    /* Timeline */
    .timeline {
      position: relative;
      padding: 2rem 0;
    }
    .timeline::before{
      content:'';
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      width:4px;
      height:100%;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border-radius: 4px;
    }

    /* central icon */
    .node {
      width:48px; height:48px; border-radius:999px;
      display:flex; align-items:center; justify-content:center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
      transition: transform .28s ease, box-shadow .28s ease;
      transform-origin:center center;
    }

    /* left/right card alignment */
    .kpi-card {
      width: calc(50% - 3.5rem);
      padding: .75rem 1rem;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(2,6,23,0.6);
      transition: transform .35s cubic-bezier(.2,.9,.25,1), opacity .35s ease, filter .35s ease;
      transform-origin: left center;
    }

    /* when node in view */
    .in-view { transform: scale(1.06); box-shadow: 0 12px 30px rgba(0,0,0,0.7); }

    /* small / out of view */
    .out-view { transform: scale(.88); opacity:.6; filter: blur(.1px); }

    /* alternate sides */
    .left-wrap { display:flex; justify-content:flex-end; gap:1rem; align-items:center; }
    .right-wrap { display:flex; justify-content:flex-start; gap:1rem; align-items:center; }

    /* responsive tweaks */
    @media (max-width:640px){
      .kpi-card { width: calc(100% - 5rem); font-size: .95rem; }
      .timeline::before { left: 48px; transform:none; } /* move vertical line right for mobile */
      .node { position: absolute; left: 24px; transform:none; }
      .left-wrap, .right-wrap { flex-direction: row; justify-content:flex-start; }
    }

    /* nice transitions for entry */
    .reveal { transform: translateY(20px) scale(.96); opacity:0; transition: all .6s cubic-bezier(.2,.9,.25,1); }
    .reveal.show { transform: translateY(0) scale(1); opacity:1; }

    /* header accent */
    .logo-accent { background: linear-gradient(90deg,var(--accent),var(--accent-2)); -webkit-background-clip:text; background-clip:text; color:transparent; font-weight:700; }

  </style>
</head>
<body>

  <main class="max-w-xl mx-auto p-4">

    <!-- HEADER -->
    <header class="mb-4">
      <h1 class="text-xl font-semibold logo-accent">FFVV Transblanco J &amp; M S.R.L</h1>
      <p class="text-xs text-slate-400 mt-1">Cierre de KPI - Vendedores</p>
    </header>

    <!-- FILTERS -->
    <section class="mb-4 grid grid-cols-3 gap-3">
      <select id="filterYear" class="glass p-2 rounded">
        <!-- JS fills -->
      </select>
      <select id="filterMonth" class="glass p-2 rounded">
        <!-- JS fills -->
      </select>
      <select id="filterZone" class="glass p-2 rounded">
        <!-- JS fills -->
      </select>
    </section>

    <!-- PROFILE -->
    <section id="profile" class="glass p-3 rounded mb-4 flex items-center gap-3">
      <img id="sellerPhoto" src="https://via.placeholder.com/96" alt="vendedor" class="w-20 h-20 rounded-full object-cover ring-2 ring-white/10 shadow-sm" />
      <div class="flex-1">
        <div id="sellerName" class="text-lg font-semibold">Nombre Vendedor</div>
        <div id="sellerBday" class="text-xs text-slate-400 mt-1">Cumplea√±os: --/--/----</div>
        <div class="text-xs text-slate-400 mt-2">Zona: <span id="sellerZone">PE05028</span></div>
      </div>
      <div class="text-right">
        <div class="text-xs text-slate-400">Resumen</div>
        <div class="font-semibold text-white">Avance global <span id="sellerOverall">82%</span></div>
      </div>
    </section>

    <!-- TIMELINE -->
    <section id="timelineWrap" class="timeline relative">
      <!-- JS will inject timeline items here -->
    </section>

    <!-- footer hint -->
    <footer class="mt-6 text-center text-xs text-slate-500">Desliza hacia abajo para ver KPIs ‚Äî dise√±ando para m√≥viles.</footer>
  </main>

  <script>
    /***** SAMPLE DATA (replace with your real data) *****/
    const SAMPLE_ZONES = ['PE05028','PE05029','PE05030'];
    const SAMPLE_YEARS = [2023,2024,2025];
    const SAMPLE_MONTHS = [
      {val:1,name:'Enero'},{val:2,name:'Febrero'},{val:3,name:'Marzo'},
      {val:4,name:'Abril'},{val:5,name:'Mayo'},{val:6,name:'Junio'},
      {val:7,name:'Julio'},{val:8,name:'Agosto'},{val:9,name:'Sept'},{val:10,name:'Oct'},{val:11,name:'Nov'},{val:12,name:'Dic'}
    ];

    const SAMPLE_DATA = {
      // keyed by zone -> sellers list
      'PE05028': [
        {
          id:1, photo:'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=800&q=60&auto=format&fit=crop',
          name:'Carlos Ruiz', birthday:'1989-06-15',
          overall:82,
          kpis: [
            { id:'k1', side:'left', type:'comisional', title:'Cobertura PDV', value:'78%', desc:'Clientes visitados vs plan', icon:'‚öë' },
            { id:'k2', side:'right', type:'incentivos', title:'Venta X', value:'120%', desc:'Meta mensual', icon:'üí∞' },
            { id:'k3', side:'left', type:'comisional', title:'Fotos subidas', value:'10/12', desc:'Evidencias', icon:'üì∏' },
            { id:'k4', side:'right', type:'incentivos', title:'Upsell', value:'3', desc:'Nuevos SKUs', icon:'‚ú®' }
          ]
        },
        {
          id:2, photo:'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=802&q=60&auto=format&fit=crop',
          name:'Mar√≠a G√≥mez', birthday:'1992-09-03',
          overall:91,
          kpis: [
            { id:'k1', side:'left', type:'comisional', title:'Cobertura PDV', value:'88%', desc:'Clientes visitados vs plan', icon:'‚öë' },
            { id:'k2', side:'right', type:'incentivos', title:'Venta X', value:'110%', desc:'Meta mensual', icon:'üí∞' },
            { id:'k3', side:'left', type:'incentivos', title:'Activaci√≥n', value:'5', desc:'Promos realizadas', icon:'üéØ' },
          ]
        }
      ],
      'PE05029': [
        // other sellers
      ]
    };

    /***** UI BOILERPLATE *****/
    const el = sel => document.querySelector(sel);
    const byId = id => document.getElementById(id);

    // fill filters
    function populateFilters(){
      const fy = byId('filterYear');
      SAMPLE_YEARS.forEach(y => {
        const o = document.createElement('option'); o.value=y; o.textContent=y; fy.appendChild(o);
      });
      const fm = byId('filterMonth');
      SAMPLE_MONTHS.forEach(m => { const o = document.createElement('option'); o.value=m.val; o.textContent=m.name; fm.appendChild(o); });
      const fz = byId('filterZone');
      SAMPLE_ZONES.forEach(z => { const o = document.createElement('option'); o.value=z; o.textContent=z; fz.appendChild(o); });
      // default selects
      fy.value = new Date().getFullYear();
      fm.value = new Date().getMonth()+1;
      fz.value = SAMPLE_ZONES[0];
    }

    // render profile & timeline for the first seller in zone
    function renderForZone(zone){
      const sellers = SAMPLE_DATA[zone] || [];
      if(!sellers.length){
        byId('profile').classList.add('hidden');
        byId('timelineWrap').innerHTML = `<div class="text-center text-sm text-slate-400 py-8">No hay datos para ${zone}</div>`;
        return;
      }
      // pick first seller for now (could be selector)
      const seller = sellers[0];
      byId('sellerPhoto').src = seller.photo;
      byId('sellerName').textContent = seller.name;
      byId('sellerBday').textContent = `Cumplea√±os: ${new Date(seller.birthday).toLocaleDateString()}`;
      byId('sellerZone').textContent = zone;
      byId('sellerOverall').textContent = seller.overall + '%';

      // build timeline items
      const wrap = byId('timelineWrap');
      wrap.innerHTML = ''; // reset
      // create spaced items
      seller.kpis.forEach((k, idx) => {
        const item = createTimelineItem(k, idx);
        wrap.appendChild(item);
      });

      // after DOM built, wire observer
      initObservers();
    }

    // helper: create timeline DOM node
    function createTimelineItem(kpi, idx){
      const container = document.createElement('div');
      container.className = 'mb-8 relative reveal';
      container.style.zIndex = 10;

      // wrapper to hold left/right card + node
      const inner = document.createElement('div');
      inner.className = kpi.side === 'left' ? 'left-wrap items-center' : 'right-wrap items-center';

      // create card
      const card = document.createElement('div');
      card.className = 'kpi-card glass';
      card.innerHTML = `
        <div class="flex items-start gap-3">
          <div>
            <div class="text-xs text-slate-400">${kpi.title}</div>
            <div class="text-lg font-semibold mt-1">${kpi.value}</div>
            <div class="text-xs text-slate-400 mt-2">${kpi.desc}</div>
          </div>
        </div>
      `;

      // style card by type
      if(kpi.type === 'comisional'){
        card.style.borderLeft = '4px solid '+getComputedStyle(document.documentElement).getPropertyValue('--comisional');
      } else {
        card.style.borderLeft = '4px solid '+getComputedStyle(document.documentElement).getPropertyValue('--incentivos');
      }

      // node (icon circle)
      const node = document.createElement('div');
      node.className = 'node glass';
      node.innerHTML = `<div style="font-size:18px">${kpi.icon}</div>`;
      // color node background by type
      if(kpi.type === 'comisional'){
        node.style.background = 'linear-gradient(90deg,var(--comisional),rgba(16,185,129,.9))';
      } else {
        node.style.background = 'linear-gradient(90deg,var(--incentivos),rgba(249,115,22,.9))';
      }

      // arrangement: on mobile, node is left (absolute) and card flows below; elsewhere alternate left/right
      if(window.innerWidth <= 640){
        // mobile: node absolute on left; card full width
        node.style.position = 'absolute'; node.style.left = '8px'; node.style.top = '0';
        card.style.marginLeft = '3.5rem';
        inner.appendChild(card);
        inner.appendChild(node);
      } else {
        if(kpi.side === 'left'){
          inner.appendChild(card);
          inner.appendChild(node);
        } else {
          inner.appendChild(node);
          inner.appendChild(card);
        }
      }

      container.appendChild(inner);
      return container;
    }

    // observe reveal + node in-view scaling
    function initObservers(){
      const reveals = document.querySelectorAll('.reveal');
      const options = { root:null, rootMargin: '0px', threshold: .2 };
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(ent => {
          if(ent.isIntersecting){
            ent.target.classList.add('show');
            // scale up nodes inside
            const node = ent.target.querySelector('.node');
            if(node) node.classList.add('in-view');
            ent.target.classList.remove('out-view');
          } else {
            ent.target.classList.remove('show');
            const node = ent.target.querySelector('.node');
            if(node) node.classList.remove('in-view');
            ent.target.classList.add('out-view');
          }
        });
      }, options);
      reveals.forEach(r => observer.observe(r));
    }

    // helper to get CSS var
    function cssVar(name){
      return getComputedStyle(document.documentElement).getPropertyValue(name);
    }
    // polyfill for color retrieval used earlier
    // wire filters
    function wireFilters(){
      byId('filterZone').addEventListener('change', (e)=> {
        renderForZone(e.target.value);
      });

      // optional: change year/month triggers reload if you implement data backend
      byId('filterYear').addEventListener('change', ()=> {/* TODO */});
      byId('filterMonth').addEventListener('change', ()=> {/* TODO */});
    }

    // init
    (function init(){
      populateFilters();
      wireFilters();
      renderForZone(byId('filterZone').value);
      // subtle scroll behavior
      document.documentElement.style.scrollBehavior = 'smooth';
    })();

    // handle resize to re-render for responsive placement
    let resizeTO;
    window.addEventListener('resize', ()=> {
      clearTimeout(resizeTO);
      resizeTO = setTimeout(()=> renderForZone(byId('filterZone').value), 240);
    });

  </script>
</body>
</html>

